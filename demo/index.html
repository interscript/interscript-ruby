<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="./style.css">
    <script src="../vendor/assets/javascripts/maps.js"></script>
    <script src="../vendor/assets/javascripts/interscript.js" defer="true"></script>
  </head>
  <body>
    <h1 style="text-align: center;">A Javascript Version of Interscript Gem</h1>
    <div class="pannel">
      <div class="pannel-input">
        <label>system code: </label>
        <select id="sc">          
          <script>
         Object.keys(window.yaml_files).forEach(sc => {
           if(sc === "bgnpcgn-rus-Cyrl-Latn-1947") {
            document.write(`<option value="${sc}" selected>${sc}</option>`);
           } else {
            document.write(`<option value="${sc}">${sc}</option>`);
           }
         })                
          </script>
        </select>
      </div>
      <div class="pannel-input">
        <div class="src">
          <label>source</label>    
          <textarea id="src"></textarea>
        </div>
        <div class="tar">
          <label>target</label>    
          <textarea id="tar"></textarea>
        </div>
      </div>
      <div class="control">
        <input type="button" value="Convert" onClick="convert()"/>
      </div>
    </div>
  </body>
  <script>
    function convert(){
      var input = document.getElementById("src"),       
          output = document.getElementById("tar"),
          sel = document.getElementById("sc");
      if(!input.value) {
        input.focus();
        return;
      };      
      const system_code = sel.options[sel.selectedIndex].text;
      var result = Opal.Interscript.$transliterate(system_code, input.value);
      output.value = result;
      alert('Successfully done!');
    }
  </script>
</html>